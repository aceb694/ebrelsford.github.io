<!DOCTYPE html>
<html>
    <head>
        <title>Class 9 | Advanced GIS</title>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />

        <link href='http://fonts.googleapis.com/css?family=Alegreya Sans' rel='stylesheet' type='text/css'>

        <link href="css/pig.css" rel="stylesheet" type="text/css" />
        <link href="css/base.css" rel="stylesheet" />

        <script src="js/pig.js"></script>
    </head>
    <body>

        <div class="slide">
            <p>Welcome to Advanced GIS, Lecture 9</p>
            <p>This is a web page that can be viewed as slides.</p>
            <p>→ to move forward</p>
            <p>← to go back</p>
        </div>

        <div class="slide" style="background-image: url(img/css-ru.png);">
            <a href="http://luor605.cartodb.com/viz/f52161be-bd66-11e4-80cf-0e0c41326911/public_map" class="source">Ruqing</a>
        </div>

        <div class="slide" style="background-image: url(img/css-jenna.png);">
            <a href="http://engej098.neocities.org/Assignment8.html" class="source">Jenna</a>
        </div>

        <div class="slide" style="background-image: url(img/css-ron.png);">
            <a href="http://prodega.neocities.org/" class="source">Ron</a>
        </div>

        <div class="slide">
            <h1>Advanced GIS</h1>
            <p>Class 9</p>
        </div>

        <div class="slide">
            <h1>JavaScript</h1>
        </div>

        <div class="slide">
            <h2>embed a CartoDB map</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-embed.png);">
            <a href="embed-map.html" class="source">example</a>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-embed-share.png);">
        </div>

        <div class="slide">
            <pre style="font-size: 40px; line-height: 50px;"><code>
&lt;iframe width='100%' height='520' frameborder='0' 
src='http://eric.cartodb.com/viz/22a36ecc-...' 
allowfullscreen webkitallowfullscreen mozallowfullscreen
oallowfullscreen msallowfullscreen&gt;&lt;/iframe&gt;
            </code></pre>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>where we're heading</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-js-button.gif);">
            <a href="advanced-cartodb-map.html" class="source">signs</a>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-js-areas.gif);">
            <a href="http://cartodb.github.io/cartodb.js/examples/layer_selector.html" class="source">area selector</a>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>variables</h2>
        </div>

        <div class="slide">
            <pre><code>var size = 5;</code></pre>
        </div>

        <div class="slide">
            <h2>remember <em>variables</em> from CartoCSS?</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartocss-variables.png);">
        </div>

        <div class="slide" style="background-image: url(img/bucket.png); background-size: 50%;">
            <a href="http://cs-blog.khanacademy.org/2013/09/teaching-variables-analogies-and.html" class="source">khan academy</a>
        </div>

        <div class="slide" style="background-image: url(img/cat-bucket.gif); background-size: 50%;">
        </div>

        <div class="slide">
            <pre><code>var size = 5 + 1000;</code></pre>
        </div>

        <div class="slide">
            <pre><code>var name = 'Bill';</code></pre>
        </div>

        <div class="slide">
            <pre><code>var name = 'Bill';
var greeting = 'Hello, ' + name;</code></pre>
        </div>

        <div class="slide">
            <h2>objects</h2>
        </div>

        <div class="slide">
            <pre><code>var person = {
    name: 'Bill',
    age: 42
};</code></pre>
        </div>

        <div class="slide">
            <pre><code>var person = {
    name: 'Bill',
    age: 42
};</code></pre>
            <p>use <code>person.name</code> to get 'Bill' out</p>
        </div>

        <div class="slide">
            <h2>functions</h2>
        </div>

        <div class="slide">
            <pre><code>alert('hiiiii');</code></pre>
        </div>

        <div class="slide">
            <pre><code>console.log('shhhh');</code></pre>
        </div>

        <div class="slide">
            <pre><code>'maps'.toUpperCase();</code></pre>
        </div>

        <div class="slide">
            <pre><code>person.name.toUpperCase();</code></pre>
        </div>

        <div class="slide">
            <h2>libraries</h2>
        </div>

        <div class="slide">
            <h2>libraries are bundles of code that you can load onto your page</h2>
        </div>

        <div class="slide">
            <h2>libraries are generally open source and free</h2>
        </div>

        <div class="slide">
            <h2>we're going to add maps to pages with libraries</h2>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>CartoDB map in JavaScript</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-js.png);">
            <a href="basic-cartodb-map.html" class="source">example</a>
        </div>

        <div class="slide">
            <h2>3 steps:</h2>
        </div>

        <div class="slide">
            <h2>1: load CartoDB library</h2>
        </div>

        <div class="slide">
            <pre style="font-size: 20px; line-height: 30px;"><code>
&lt;link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/3.13/themes/css/cartodb.css" /&gt;
&lt;script src="http://libs.cartocdn.com/cartodb.js/v3/3.13/cartodb.js"&gt;&lt;/script&gt;</code></pre>
        </div>

        <div class="slide">
            <pre style="font-size: 20px; line-height: 30px;"><code>
&lt;link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/3.13/themes/css/cartodb.css" /&gt;
&lt;script src="http://libs.cartocdn.com/cartodb.js/v3/3.13/cartodb.js"&gt;&lt;/script&gt;</code></pre>
            <h2>(you'll copy and paste this)</h2>
        </div>

        <div class="slide">
            <h2>2: make a place for the map to go</h2>
        </div>

        <div class="slide">
            <pre><code>&lt;body&gt;
    &lt;div id="map"&gt;&lt;/div&gt;
&lt;/body&gt;</code></pre>
        </div>

        <div class="slide">
            <h2>3: tell CartoDB to create the map</h2>
        </div>

        <div class="slide">
            <pre style="font-size: 20px; line-height: 30px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis('map', 'http://eric.cartodb.com/api/v2/viz/22a36ecc-0eb6-11e3-8f2f-5404a6a69006/viz.json');
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide">
            <pre style="font-size: 35px; line-height: 45px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis('map', your_visualization_url);
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-api-code.png);">
        </div>

        <div class="slide">
            <ol>
                <li>load CartoDB library</li>
                <li>make a place for the map to go</li>
                <li>tell CartoDB to create the map</li>
            </ol>
        </div>

        <div class="slide">
            <h2>try it:</h2>
            <p>open <a href="http://jsbin.com/nifawivohi/1/edit?html,output" class="code">jsbin.com/nifawivohi</a> and replace the visualization url with one from your own maps</p>
        </div>

        <div class="slide intermission"></div>

        <div class="slide" style="background-image: url(img/cartodb-js-jsbin.png);">
            <h2>OK but that seems like a lot of effort to embed a map from CartoDB</h2>
        </div>

        <div class="slide" style="background-image: url(img/christian-bale-kermit-the-frog.gif); background-size: 50%;">
            <h2>true</h2>
        </div>

        <div class="slide">
            <h2>but there's more!</h2>
        </div>

        <div class="slide">
            <h2>more customization</h2>
        </div>

        <div class="slide">
            <h2>eg, remove the logo</h2>
        </div>

        <div class="slide">
            <pre style="font-size: 35px; line-height: 45px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis('map', your_visualization_url, {
            cartodb_logo: false
        });
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide">
            <pre style="font-size: 35px; line-height: 45px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis('map', your_visualization_url<span class="highlighted">, {
            cartodb_logo: false
        }</span>);
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide">
            <h2>try it:</h2>
            <p>remove the logo from your map</p>
            <pre style="font-size: 35px; line-height: 45px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis('map', your_visualization_url<span class="highlighted">, {
            cartodb_logo: false
        }</span>);
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-custom-layer-switcher.png);">
            <h2>or bigger changes</h2>
            <a href="http://cartodb.github.io/cartodb.js/examples/layer_selector.html" class="source">example</a>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>there are more options</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-api-docs.png);">
            <a href="http://docs.cartodb.com/cartodb-platform/cartodb-js.html#cartodbcreatevismapid-vizjsonurl-options--callback" class="source">
                CartoDB.js documentation
            </a>
        </div>

        <div class="slide">
            <h2>try it:</h2>
            <p style="font-size: 40px; line-height: 50px;">change another option on your map from <a href="http://docs.cartodb.com/cartodb-platform/cartodb-js.html#cartodbcreatevismapid-vizjsonurl-options--callback">http://docs.cartodb.com/cartodb-platform/cartodb-js.html#cartodbcreatevismapid-vizjsonurl-options--callback</a></p>
            <pre style="font-size: 35px; line-height: 45px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis('map', your_visualization_url, {
            cartodb_logo: false<span class="highlighted">,
            your_option: your_value</span>
        });
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>function</h2>
            <pre style="font-size: 40px; line-height: 50px;"><code>&lt;script&gt;
    $(document).ready(function () {
        <span class="highlighted">cartodb.createVis</span>(your_map_id,
                          your_visualization_url,
                          your_options);
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide">
            <h2>your map's id, url, options are the <em>parameters</em></h2>
        </div>

        <div class="slide">
            <h2>parameters</h2>
            <pre style="font-size: 40px; line-height: 50px;"><code>&lt;script&gt;
    $(document).ready(function () {
        cartodb.createVis(<span class="highlighted">your_map_id,
                          your_visualization_url,
                          your_options</span>);
    });
&lt;/script&gt;</code></pre>
        </div>

        <div class="slide">
            <h2>parameters affect the way a function works</h2>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>jQuery</h2>
        </div>

        <div class="slide">
            <h2>jQuery</h2>
            <p>makes it easy to do some common things in JavaScript</p>
        </div>

        <div class="slide">
            <h2>anything starting with <code>$</code> is talking to jQuery</h2>
        </div>

        <div class="slide">
            <h2>(it's not standard JavaScript)</h2>
        </div>

        <div class="slide">
            <h2><code>$('#map')</code></h2>
        </div>

        <div class="slide">
            <h2><code>$('#map').hide()</code></h2>
        </div>

        <div class="slide">
            <pre><code>$('#map').animate({ opacity: 0 })</code></pre>
        </div>

        <div class="slide">
            <h2>try this on your map in the console:</h2>
            <pre><code>$('#map').animate({ width: 0 })</code></pre>
        </div>

        <div class="slide">
            <pre><code>$('#map').click(function () {
    console.log("I've been clicked");
});</code></pre>
        </div>

        <div class="slide" style="background-image: url(img/deliveries.jpg);">
        </div>

        <div class="slide">
            <h2>pick the <code>div</code> with <code>id</code> "map"</h2>
            <pre><code><span class="highlighted">$('#map')</span>.click(function () {
    console.log("I've been clicked");
});</code></pre>
        </div>

        <div class="slide">
            <h2>when it's clicked</h2>
            <pre><code>$('#map')<span class="highlighted">.click</span>(function () {
    console.log("I've been clicked");
});</code></pre>
        </div>

        <div class="slide">
            <h2>run this code</h2>
            <pre><code>$('#map').click<span class="highlighted">(function () {
    console.log("I've been clicked");
});</span></code></pre>
        </div>

        <div class="slide">
            <h2>try it:</h2>
            <p>add this in your map file on <strong>the line after</strong> <code>createVis</code>:</p>
            <pre><code>$('#map').click(function () {
    console.log("I've been clicked");
});</code></pre>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>back to CartoDB</h2>
        </div>

        <div class="slide">
            <h2>let's make a button that changes what's on the map</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-custom-layer-switcher.png);">
            <h2>like this one</h2>
        </div>

        <div class="slide">
            <h2>four steps:</h2>
            <ol>
                <li>create a button</li>
                <li>get the map layer</li>
                <li>listen for a click on the button</li>
                <li>change the layer's SQL</li>
            </ol>
        </div>

        <div class="slide">
            <h2>look at <a href="http://jsbin.com/gusevenoce/1/edit?html,output">jsbin.com/gusevenoce</a></h2>
        </div>

        <div class="slide">
            <h2>1. create a button</h2>
            <pre><code>&lt;div id="just-manhattan"&gt;
    just Manhattan
&lt;/div&gt;</code></pre>
        </div>

        <div class="slide" style="background-image: url(img/just-manhattan-button.png);">
        </div>

        <div class="slide">
            <h2>2. get the map layer</h2>
            <pre style="font-size: 50px; line-height: 60px;"><code>
cartodb.createVis(...)
.done(function (vis, layers) {
    dataLayer = layers[1].getSubLayer(0);     
});</code></pre>
        </div>

        <div class="slide">
            <h2>3. listen for a click on the button</h2>
            <pre style="font-size: 50px; line-height: 60px;"><code>$('#just-manhattan').click(function () {
    ...
});</code></pre>
        </div>

        <div class="slide">
            <h2>4. change the layer's SQL</h2>
            <pre style="font-size: 25px; line-height: 35px;"><code>$('#just-manhattan').click(function () {
    var sql = "SELECT * FROM sign_application_filings WHERE borough = 'MANHATTAN'";
    dataLayer.setSQL(sql);
});</code></pre>
        </div>

        <div class="slide">
            <h2>try it:</h2>
            <p>edit <a href="http://jsbin.com/gusevenoce/1/edit?html,output">jsbin.com/gusevenoce</a> to select a different borough</p>
        </div>

        <div class="slide">
            <h2>try it:</h2>
            <p>edit <a href="http://jsbin.com/gusevenoce/1/edit?html,output">jsbin.com/gusevenoce</a> to work for one of your maps</p>
            <p>(load your map, change SQL for your map)</p>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>getting to know JavaScript</h2>
        </div>

        <div class="slide" style="background-image: url(img/khan-academy-js.png);">
            <a href="https://www.khanacademy.org/computing/computer-programming/programming" class="source">khan academy</a>
        </div>

        <div class="slide" style="background-image: url(img/codecademy.png);">
            <a href="http://www.codecademy.com/tracks/javascript" class="source">Codecademy</a>
        </div>

        <div class="slide" style="background-image: url(img/eloquent-js.png);">
            <a href="http://eloquentjavascript.net/" class="source">Eloquent JavaScript</a>
        </div>

    </body>
</html>
